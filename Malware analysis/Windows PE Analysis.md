
### Sample info :

```bash
d551a474ecf0b7d1ba6dda319e3b77fdecf39489eaf14b7d8837002f2d31387b.exe.defanged: PE32 executable (GUI) Intel 80386 Mono/.Net assembly, for MS Windows, 3 sections
```

![[Pasted image 20260106164956.png]]

Using
```bash
rabin2 -I vuln
```
This is the result of security techniques used by the malware :
```bash
arch     x86
baddr    0x400000
binsz    1307648
bintype  pe
bits     32
canary   true
injprot  false
retguard false
class    PE32
cmp.csum 0x00148220
compiled Sat Jul 22 07:53:55 2017
crypto   false
dbg_file C:\Users\Ben\Desktop\Panel\project\Wanna\Wanna\obj\Debug\Wanna.pdb
endian   little
havecode true
hdr.csum 0x00000000
guid     C7D37514C1744966813CD7CCEF26F66A1
laddr    0x0
lang     cil
linenum  false
lsyms    false
machine  i386
nx       true
os       windows
overlay  false
cc       cdecl
pic      true
relocs   false
signed   false
sanitize false
static   false
stripped false
subsys   Windows GUI
va       true
```

#### Deliverable  1.1 :
#### Sample properties :
The sample is 32-bit Windows GUI **.NET (C#)** executable, built with Visual Studio in 2017, unsigned, likely packed/obfuscated, with leaked debug artifacts and standard exploit mitigations enabled.
Details : 
- Size : 1307648 bytes 
- hashes : d551a474ecf0b7d1ba6dda319e3b77fdecf39489eaf14b7d8837002f2d31387b
- Format: pei-i386 → Windows PE, 32-bit
- **Architecture**: `i386` → x86 (not x64)
- **Relocations**: `HAS_RELOC` → not fully ASLR-fixed
- **Debug info**: `HAS_DEBUG`, `HAS_LINENO`, `HAS_LOCALS` → symbols/debug remnants present
- **Paging**: `D_PAGED` → demand-paged sections
- **Entry point**: `0x005409aa`
- Endianness : Little-endian
- Type : GUI (not console)
- OS target : Windows 95+ (generic PE flag)
- Compiler/ Toolchain : Microsoft linker / Visual Studio / Language C#
- Runtime : **.NET Framework v4.5.2** (CLR v4.0.30319)
- Obfuscation/ Packing : High entropy so it s likely packed or compressed / .text section was flagged (Suspicious)
- Overlay is false
- Debug info : PDB path leaked which means weak OPSEC  (Strong dev attribution noticed)
```bash 
  C:\Users\Ben\Desktop\Panel\project\Wanna\Wanna\obj\Debug\Wanna.pdb 
```
- Security flags :  NX , Stack canary , ASLR (pic  is true but no relocs) , Signed is false
-
- **Compilation timestamp** : Sat Jul 22 07:53:55 2017 , it s old and suspicious .
- timestamps can be forged , the attackers can easy edit the timestamps (faking time) to random past date , in order to mislead the analysis of the attack (anti forensics method ) , so time is unreliable at this state (unless new info is discovered from further analysis)
- **Entry Point** :  005409aa address / the offset is : 001409aa (The base address is 00400000)
- **Packing Entropy** : ![[Pasted image 20260107110628.png]]
- The ransomware uses an unknown packing/obfuscation technique at the managed (.NET) level, resulting in a high-entropy `.text` section and minimal native imports.
- **Hashing** : ![[Pasted image 20260107111033.png]]
##### Suspicious strings : 
-  `get_Screen_Shot_2017_05_12_at_4_05_23_PM` 
-  `https://www.bitcoin.com/`
- `https://www.google.com.tr/search?q=how+to+buy+bitcoins&oq=how+to+buy+bitcoins&aqs=chrome..69i57.10301j0j1&sourceid=chrome&ie=UTF-8#q=bitcoin+nas%C4%B1l+al%C4%B1n%C4%B1r`
- **Turkish Language (author location)**: `leminiz Kontrol Edilecektir` :  It will be checked.
- `deme` : don t say / ` olduysa <Decrypt> butonu aktif olacakt` : If it worked, the `<Decrypt>` button would be active. 
- `1Hydrt8E3ybCwS7YBtggFFNn1AyrqWaBzz` : Bitcoin address (legacy P2PKH).
- `Send $7000 worth of bitcoin to this address:` 
- `Programdan bize bildirim gelecektir.`  : We will receive a notification from the program
- `QSystem.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a 
- ![[Pasted image 20260107120636.png]]****`
- 
#### Die Extractor analysis :
![[Screenshot 2026-01-07 111136.png]]
The extractor shows that the malware stores its components and payload in compressed form `.zlib`  and decompresses them at runtime, which confirms the entropy results of packing and obfuscation  of the sample . Also , the presence of embedded image resources and artifacts confirms a graphical user interface , which is consistent with ransomware family that interacts directly with the victim.
### R2 analysis :
![[Pasted image 20260107105221.png]]
- 7 functions 
- 6 calls
- 1 symbol
- 1 import
![[Pasted image 20260107105439.png]]
- The entry at 0x005409aa
#### Entry point :
- Entry Point `0x005409aa` points to **`.text`** : it s typical for PE
- If it points to data that s highly suspicious (shell code injection , changing the code )

## PE header analysis :
The PE header indicates that the sample is a valid 32-bit Windows GUI executable. The default ImageBase suggests it was compiled using standard Windows settings. Entry point points to the .text section (expected from .NET executables) . The section and file alignment values are standard which doesn t indicate any header manipulaiton. OS version fields reference Windows 95, but it doesn t reflect the target env (comptability common value in modern compilers) . Overall, the PE header appears standard and consistent , reflecting no suspicion of header tampering or corruption .

## Strings analysis : 
- **Language & tone:**  
    The majority of strings are in **Turkish**, written mostly in an informal tone (“lem ba”, “deme”), which suggests that either the **author’s native language** or a **targeted victim group**. This also indicates low OPSEC and a non-professional threat actor.  
- **Ransomware workflow clearly exposed:**
    - “**Ooops, your files have been encrypted!**” (Typical in known WannaCry family)
    - “**Send $7000 worth of bitcoin to this address**”
    - “**Check payment** / **Decrypt button will be active if it worked**”  
        These strings outline a **classic ransomware lifecycle**: encryption → ransom demand → payment verification → decryption.
        
- **Payment handling logic:**  
    References to:
    
    - a **hardcoded Bitcoin address**
        
    - “**Check Payment**” button
        
    - “**We will receive a notification from the program**”  
        suggest the malware **locally checks payment status**, likely by querying a service or comparing transactions rather than using a sophisticated C2 infrastructure.
        
- **GUI-based interaction:**  
    Strings such as `pictureBox1`, `label1`, `Microsoft Sans Serif`, and multiple form resources confirm a **Windows Forms GUI**, reinforcing that the malware relies on **user interaction**, not stealth.
    
- **Threat messaging & pressure:**  
    The text threatens permanent data loss (“**your passwords are gone**”, “**data cannot be recovered**”) while also claiming restraint (“**no damage to NAS or terminals**”), a **social engineering tactic** to pressure victims into paying quickly.
    
- **Operational weaknesses:**
    
    - Embedded **email addresses**
        
    - Clear-text ransom amount
        
    - Developer paths and project names  
        indicate **poor operational security**, making attribution and analysis easier.
        

**Overall conclusion:**  
These strings confirm the sample is a **low-to-medium sophistication GUI ransomware**, written in C#, aimed at coercing victims through direct interaction and fear-based messaging. The ransomware lacks advanced stealth or infrastructure and instead relies on hardcoded resources, local payment checks, and a simple decryption trigger.

**Research on WannaCry ransomware family :** 
- From the strings and static observation and analysis , the sample was most likely from the WannaCry ransomware family , but to confirm the suspicion i did some research about WannaCry (known attacks and events , writeups on reversing it ) , and the behavior and execution were the same as what i suspected . One of the thing that i noticed is the high similarity between the GUI displayed , and the GUI created from the sample (button names, colors , strings ) the difference was just the language , details and the threat message(which suggests the threat actor localization or its target)![[Screenshot 2026-01-07 145120.png]]
- The ransom note GUI closely resembles those used by the **WannaCry ransomware family**, particularly in layout, color scheme, countdown timers, payment instructions, and the presence of **“Check Payment”** and **“Decrypt”** buttons. This similarity, combined with the internal naming (`Wanna`, `WannaDecryptor`) and Bitcoin-based payment workflow, strongly suggests that this malware is **inspired by or imitates WannaCry**, rather than being the original strain. Overall, the GUI comparison reinforces the conclusion that the sample is a **WannaCry-style ransomware clone with similar user-interaction and coercion mechanisms**.
- The PE advertises ASLR (DYNAMIC_BASE) and DEP (NX_COMPAT). A relocation table is present but very small (1 relocation block), so ASLR support exists but relocations appear limited. 
- ```bash
  DOS Header
    Magic number:                    0x5a4d (MZ)
    Bytes in last page:              144
    Pages in file:                   3
    Relocations:                     0
    Size of header in paragraphs:    4
    Minimum extra paragraphs:        0
    Maximum extra paragraphs:        65535
    Initial (relative) SS value:     0
    Initial SP value:                0xb8
    Initial IP value:                0
    Initial (relative) CS value:     0
    Address of relocation table:     0x40
    Overlay number:                  0
    OEM identifier:                  0
    OEM information:                 0
    PE header offset:                0x80
PE header
    Signature:                       0x00004550 (PE)
COFF/File header
    Machine:                         0x14c IMAGE_FILE_MACHINE_I386
    Number of sections:              3
    Date/time stamp:                 1500724435 (Sat, 22 Jul 2017 11:53:55 UTC)
    Symbol Table offset:             0
    Number of symbols:               0
    Size of optional header:         0xe0
    Characteristics:                 0x22
    Characteristics names
                                         IMAGE_FILE_EXECUTABLE_IMAGE
                                         IMAGE_FILE_LARGE_ADDRESS_AWARE
Optional/Image header
    Magic number:                    0x10b (PE32)
    Linker major version:            48
    Linker minor version:            0
    Size of .text section:           0x13ea00
    Size of .data section:           0x800
    Size of .bss section:            0
    Entrypoint:                      0x1409aa
    Address of .text section:        0x2000
    Address of .data section:        0x142000
    ImageBase:                       0x400000
    Alignment of sections:           0x2000
    Alignment factor:                0x200
    Major version of required OS:    4
    Minor version of required OS:    0
    Major version of image:          0
    Minor version of image:          0
    Major version of subsystem:      6
    Minor version of subsystem:      0
    Win32 version value:             0
        Overwrite OS major version:      (default)
        Overwrite OS minor version:      (default)
        Overwrite OS build number:       (default)
        Overwrite OS platform id:        (default)
    Size of image:                   0x146000
    Size of headers:                 0x200
    Checksum:                        0
    Subsystem required:              0x2 (IMAGE_SUBSYSTEM_WINDOWS_GUI)
    DLL characteristics:             0x8560
    DLL characteristics names
                                         IMAGE_DLLCHARACTERISTICS_HIGH_ENTROPY_VA
                                         IMAGE_DLLCHARACTERISTICS_DYNAMIC_BASE
                                         IMAGE_DLLCHARACTERISTICS_NX_COMPAT
                                         IMAGE_DLLCHARACTERISTICS_NO_SEH
                                         IMAGE_DLLCHARACTERISTICS_TERMINAL_SERVER_AWARE
    Size of stack to reserve:        0x100000
    Size of stack to commit:         0x1000
    Size of heap space to reserve:   0x100000
    Size of heap space to commit:    0x1000
    Loader Flags:                    0
    Loader Flags names
Data directories
    Directory
        IMAGE_DIRECTORY_ENTRY_IMPORT:    0x140958 (79 bytes)
    Directory
        IMAGE_DIRECTORY_ENTRY_RESOURCE:  0x142000 (1420 bytes)
    Directory
        IMAGE_DIRECTORY_ENTRY_BASERELOC: 0x144000 (12 bytes)
    Directory
        IMAGE_DIRECTORY_ENTRY_DEBUG:     0x140820 (28 bytes)
    Directory
        IMAGE_DIRECTORY_ENTRY_IAT:       0x2000 (8 bytes)
    Directory
        IMAGE_DIRECTORY_ENTRY_COM_DESCRIPTOR:    0x2008 (72 bytes)
Imported functions
    Library
        Name:                            mscoree.dll
        Functions
            Function
                Hint:                            0
                Name:                            _CorExeMain
Exported functions
Sections
    Section
        Name:                            .text
        Virtual Size:                    0x13e9b0 (1305008 bytes)
        Virtual Address:                 0x2000
        Size Of Raw Data:                0x13ea00 (1305088 bytes)
        Pointer To Raw Data:             0x200
        Number Of Relocations:           0
        Characteristics:                 0x60000020
        Characteristic Names
                                             IMAGE_SCN_CNT_CODE
                                             IMAGE_SCN_MEM_EXECUTE
                                             IMAGE_SCN_MEM_READ
    Section
        Name:                            .rsrc
        Virtual Size:                    0x58c (1420 bytes)
        Virtual Address:                 0x142000
        Size Of Raw Data:                0x600 (1536 bytes)
        Pointer To Raw Data:             0x13ec00
        Number Of Relocations:           0
        Characteristics:                 0x40000040
        Characteristic Names
                                             IMAGE_SCN_CNT_INITIALIZED_DATA
                                             IMAGE_SCN_MEM_READ
    Section
        Name:                            .reloc
        Virtual Size:                    0xc (12 bytes)
        Virtual Address:                 0x144000
        Size Of Raw Data:                0x200 (512 bytes)
        Pointer To Raw Data:             0x13f200
        Number Of Relocations:           0
        Characteristics:                 0x42000040
        Characteristic Names
                                             IMAGE_SCN_CNT_INITIALIZED_DATA
                                             IMAGE_SCN_MEM_DISCARDABLE
                                             IMAGE_SCN_MEM_READ
  ```
  