Concolic execution
fuzzing
Sources and sinks : to find vulns : taint analysis
ASAN : address Sanitizer
Malware Bazzare
Mitre Entreprise techniques

	- Attack / Campaing / Identity / COurse of action /Indicator / Location / Malware /Threat actor / Tool / Vulnerability 
	- Exract graphs : node with name and type and relationships as edges.
# LAB 1:
## Ai Threat : (Report C)

- Attack : agent session smuggling
## Report  B : Ransomware :

- Family :  Ransomware 
- Ransomware family : 01flip
- Target : limited set of victims in the Asia-Pacific region.
- Language : Rust
- Supports multi-platform architectures by leveraging the cross-compilation feature of Rust in cluding windows and linux
- Motivation : financially motivated
- Attackers carried this out through manual means.
- Discovery : Data leak from an affected organization on a dark web forum shortly after the attack
- CL-CRI-1036, signifying a cluster of malicious activity that is likely related to cybercrime
- A threat actor potentially associated with CL-CRI-1036 is offering data for sale on dark web forums 
- Unit 42 researchers investigated a suspicious Windows executable
- Victim : organizations responsible for critical infrastructure in Southeast Asia / victims in Taiwan and the Philippines were also targeted .
- Attackers had compromised their Zimbra Server, which is an email solution for enterprises.
- Initial access tries :  [CVE-2019-11580](https://nvd.nist.gov/vuln/detail/cve-2019-11580) against a victim’s internet-facing applications
- Initial access : they successfully deployed a Linux version of [Sliver](https://github.com/BishopFox/sliver), a publicly available cross-platform adversary emulation framework written in Go.
- Post exploitation : Lateral movement to another Linux machine by Silver implant : TCP pivot.
- Extended the ransomware onto many devices within the network .
- How :  Hands-on reconnaissance / Credential dumping / Lateral movement 
- Initial analysis: Not packed or heavily obfuscated / Compiled from rust (file extension .rs)
- Most of the functionality is identical between linux and windows samples.
- The malware Capabilities are simple and straightforward, the complexity of Rust is what s challenging .
- Functionality : Enumerating all possible drives (e.g., from A: to Z:) / Creating ransom notes, RECOVER-YOUR-FILE.TXT, in all writable directories / Renaming files containing specific file extensions with the following naming convention: <ORIGINAL_FILENAME>.<UNIQUE_ID>.<0 or 1>.01flip / Encrypting files using AES-128-CBC and RSA-2048 / Deleting itself . 
- Defense Evasion techniques : using less api and system calls .
- User-defined strings are encoded , those are decoded at the runtime .
- Those strings : ransom note content , ransom note filename, extension list , RSA public key.
- Encoded strings are embedded in the .text or .data section of the Windows variant based on length .
- Easy to detect .
- Anti-sandbox technique : checks wether the filename contains the string 01flip .
- If the sample's filename contains the string 01flip, the ransomware proceeds to [indicator removal](https://attack.mitre.org/techniques/T1070/) without performing file encryption 
- Data encryption : 01flip ransomware drops ransom notes in all writable directories before encrypting files. 
- Ransom notes : contact information , cipher data to obtain a key to decrypt victim's files .
- It excludes files with specific extensions from encryption , the list is in Appendix.
- Encryption Algorithm : AES 
- Session key for file-encrypting activity encryption : embedded RSA public key.
- Indicator removal : after encryption , the ransomware attempts to remove any trace of itself.
- Attackers Activity : Demand one bitcoin (BTC ) for decrypting files / communication takes place in a secure email or private messaging channel.
- Attacker Identity : from a dark web forum , posted after ransomware deployment , the only info is that the username of the author is same as a Russian-speaking user has been selling data and network access on well-known dark web forum XSS since 2020 .
- Ransomware cannot exfiltrate data , the only connection between the poster and 01flip is the victim .
- Suspicious observation : lockbit encryption avoidance implies possible overlap between the threat actor behind CL-CRI-1036 and the group behind LockBit ransomware, Flighty Scorpius.
- No other connection between those 2 families .
- Difficulty of reversing modern programming languages as Rust.
- Early stage of this campaing.
- Palo Alto Networks Protection : Advanced WildFire machine learning models has been updated based on this research.
- Cortex XDR and XSIAM employs Malware Prevention Engine.
- 
